% \input utf8-t1
\documentclass[16pt,titlepage,a4paper]{article}

% ------ PACKAGES ------

\usepackage[czech]{babel}
\usepackage[utf8]{inputenc}
\usepackage{hyperref}
\usepackage{listings}
\usepackage{color}
\usepackage{xcolor}
\usepackage{newverbs}
% \usepackage{minted}

% ------ CUSTOM COLORS ------

\colorlet{violet}{blue!75!red}
\colorlet{lightgray}{gray!12}

% ------ CUSTOM COMMANDS ------

\makeatletter
\newcommand\ic[1][green]{%
    \@testopt{\@ic{#1}}{-#1}% Handle second optional argument
}
\def\@ic#1[#2]{%
    \Collectverb{\@@ic{#1}{#2}}%
}
\def\@@ic#1#2#3{%
    %\begingroup
    %\fboxrule=0.9\baselineskip
    %\fboxsep=...
    \fcolorbox{white}{lightgray}{\lstinline[columns=fixed,basicstyle=\ttfamily\color{violet}]|#3|}%
    %\endgroup
}
\makeatother

\newcommand*{\fullref}[1]{\hyperref[{#1}]{\autoref*{#1} \nameref*{#1}}} % One single link

% ------ LISTINGS  ------

\lstset{
    language=Python,
    % frameround=fttt,
    breaklines=true
    keywordstyle=\color{blue}, 
    basicstyle=\color{violet},
    numberstyle=\color{black}
}

\begin{document}

    \title{Pybots - server pro automatickou hru robotů}
    \author{Josef Kolář}
    \date{leden 2016}


\maketitle
\tableofcontents
\newpage


\section{Teoretický úvod}

\subsection{Rozbor zadání}

\subsection{Návrh architektury aplikace}

\subsubsection{Návrh interní struktury}

\textit{
	V této kapitole se budu zabývat pouze teoretickým návrhem jednotlivých datových a řídící struktur. Popisu použitých algoritmů a jednotlivých implementačních rozhodnutí se budu věnovat v sekci \fullref{sec:implementation}.
}

O interní reprezentaci jedné instance hry se stará třída \ic|Game|, která je zodpovědná za striktní přístup klienta do mapy. Zpracovávvá jednotlivé herní akce klientů, kontroluje jejich validitu a aplikuje změny do mapy. \ic|Game| je sama schopna se vyexportovat do slovníku, který je následně převeden do formátu JSON a distribuován ke klientovi. Při herních akcích překládá výjimky vyolané interně uloženou mapou na vyjímky zvenku známé. V případě módu hry s tahy hlídá \ic|Game| pořadí jednotlivých botů.

Třída \ic|Game| interně využívá třídu Map k uchování stavu hry. Třída \ic|Map| je v podstatě pouze zapouzdřený dvourozměrný kontejner reprezentující vlastní mapu. Je zodpovědná za validní přístup - tzn. mj. ošetřuje stavy pro přístup mimo rozsah mapy.

Třída, která kontroluje jednotlivé instance \ic-Game- v aplikaci se příznačně nazývá \ic*GameController*

\subsubsection{Návrh vnějšího rozhraní}

\subsection{Administrace}

\section{Implementace}
\label{sec:implementation}

\section{Použité technologie}

\subsection{Python}

Python je moderní interpretovaný programovací jazyk, který byl navržen v roce 1991 nizozemským programátorem Guido van Rossumem. Nabízí rozličná programovací paradigma: imperativní, procudurální, funkcionální nebo objektově orientované, které jsem ve své práci použil nejčastěji.

Python je vyvíjen jako open source projekt, jeho zdrojové kódy jsou tedy veřejné a je možné do nich přispět. Jeho výchozí implementace se nazývá \uv{CPython} dle jazyka C, ve kterém je implementována. Mezi další jeho alternativní implementace patří \uv{Jython} naprogramovaný v jazyce Java nebo \uv{IronPython} v prostředích .NET a Mono.

Jednou z velkých výhod Pythonu je jeho rozšířitelnost. Oficiální portál pro rozšiřující balíčky \href{https:\/\/pypi.python.org\/pypi}{PyPi} aktuálně nabízí okolo 74 tisíc knihoven. Kterýkoliv z těchto balíčků je možno pomocí nástroje pip nainstalovat a používat. Jednou z dalších možností, jak rozšířit jeho funkčnost, je naprogramovat si vlastní rozšíření v jazyce C.

Python je aktuálně vyvíjen ve dvou hlavních větvích; větvi Pythonu verze 2 a verze 3. Motivace pro vydání verze 3 byla především ve sjednocení práce s řetězci (Python verze 2 rozlišoval řetězce ASCII znaků a řetězce Unicode znaků), celočíselného dělení a některých vylepšení syntaxe jazyka.

\subsubsection{Automatické testování}

Automatické testování je jeden z způsobů, jak vývojáři ulehčit úpravu, vytváření i mazání částí zdrojových kódů. Jednotka testu je v množina asercí (předpokladů), které kontrolují vývojářem vytvořené modelové situace nad zdrojovým kódem programu. Automatické testování je poté automatické spouštění testů např. po změně zdrojového kódu a určení, zda testy prošly korektně (aserce všech testů jsou pravdivé). Samotný test je však psán samotným vývojářem, což při testování může vytvářet klamný dojem \uv{bezchybnosti} zdrojového kódu projektu, protože vývojář jakožto člověk, je bytost chybující a samotný kód testů může být napsat chybně a aserce jsou v tu chvíli bezpředmětné, protože jsou např. vždy pravdivé a znehodnocují tím korektnost  a správnost testů projektu.

\subsection{Flask}

Flask je webový framework implementovaný v jazyce Python. Mezi jeho přednosti patří vestavěný vývojářský server, plná podpora pro unit testování a kvalitní dokumentace. Vzhledem k jeho variabilitě a v základu tenké architektuře bylo nutné přidat abstraktní vrstvy pro samotné zpracování herních akcích a podobně.

Vzhledem k tomu, že je framework téměř stoprocentně pokryt testy, lze jednodušše usuzovat z těchto testů o funkčnostech frameworku a také je velmi snadné psát vlastní testy na kteroukoliv komponentu aplikace.
\subsection{HTTP}

HTTP (HyperText Transfer Protocol) je standardizovaný internetový protokol pro výměnu HTML kódu. Jeho první koncept vznikl v roce 1991 jako veze 0.9, o pět let později byla uvedena verze 1.1 a verze 1.1, která je používaná dodnes byla uvedena v červu roku 1999. V dnešní době je používán nejen k výměně HTML kódu, ale jeho rozšíření MIME \footnote{Multipurpose Internet Mail Extensions} poskytuje možnost přenosu souborů jakéhokoliv typu. Samotný HTTP nezajištuje zabezpečení ani integritu dat. Nadstavbu nad HTTP tvoří HTTPS, jehož komunikace je šifrována pomocí SSL nebo TLS.

HTTP pracuje na principu request-response (požadavek-odpověd). HTTP požadavek ve formě plaintextu je vyslán ze klientského zařízení, ten je serverem zpracován a nazpět jsou odeslány tzv. hlavičky odpovědi a poté i samotné její tělo. Vzhledem k tomu, že každý další následující dotaz klienta na server bude nezávislý na těch předchozích, je nutno označit tento protokol za bezstavový. Nelze tedy uchovávat stav komunikace a jednotlivé požadavky nemají mezi sebou souvislost. Tato vlastnost může být částečně potlačena použitím HTTP cookies, které jsou schopny téměř jednoznačně identifikovat klientské zařízení na serveru.

\subsection{JSON}

JavaScript Object Notation je datový formát pro přenos dat nezávislý na platformě. Oproti jeho hlavnímu konkurentu XML je datově úspornější, avšak je nevhodný k přenosu binárních informací. JSON je schopen kódovat a následně dekódovat tyto datové typy:

\begin{itemize}
    \item
    \textbf{integer} - celočíselné hodnoty jako 6, -3 nebo 0.

    \item
    \textbf{float} - desetinná čísla jako 6.6, -3.5 nebo 0.9.

    \item
    \textbf{string} - řetězec znaků, např. "bar".

    \item
    \textbf{boolean} - pravdivostní hodnoty \textit{true} a \textit{false}.

    \item
    \textbf{array} - standardní netypový seznam, např. [6, 3.5, "foo"].

    \item
    \textbf{object} - seznam prvků ve struktuře \textit{klíč} - \textit{hodnota}, např. \{"foo": 6, "bar": [1, 10, 100]\}.
\end{itemize}

\end{document}
